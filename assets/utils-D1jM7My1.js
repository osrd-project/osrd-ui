import{r as l,R as x}from"./index-CDs2tPxN.js";import{c as be}from"./index-DX8y_bUt.js";import{l as R}from"./lodash-B2soob2o.js";import{c as we}from"./chroma-vMwKRLDS.js";const O=1e3,L=60*1e3;function Y(e,t,n,r,a,p,b,o){const d=[];for(let T=0;T<p;T++){let w=b+T*r,i=t[0].position;const m={id:`${e}-${T+1}`,label:`Train ${e} ${T+1}`,points:[{position:i,time:w}],...o};t.forEach((g,f)=>{if(f){const s=t[f-1],c=g.position-s.position,v=c/a;i+=c,w+=v,m.points.push({position:i,time:w})}w+=n,m.points.push({position:i,time:w})}),d.push(m)}return d}const W=[{id:"city-a",label:"Point A",position:0*O,importanceLevel:1},{id:"city-b",label:"Point B",position:10*O,importanceLevel:2},{id:"city-c",label:"Point C",position:60*O,importanceLevel:1},{id:"city-d",label:"Point D",position:70*O,importanceLevel:2},{id:"city-e",label:"Point E",position:90*O,importanceLevel:2},{id:"city-f",label:"Point F",position:140*O,importanceLevel:1}],Te=W.slice(0).reverse(),de=[W[0],W[2],W[5]],Se=de.slice(0).reverse(),Et=[...Y("omnibus",W,3*L,30*L,80*O/(60*L),5,+new Date("2024/04/02"),{color:"#FF362E"}),...Y("omnibus-reversed",Te,3*L,35*L,-(80*O)/(60*L),4,+new Date("2024/04/02"),{color:"#FF8E3D"}),...Y("fast",de,5*L,50*L,140*O/(60*L),3,+new Date("2024/04/02"),{color:"#526CE8",fromEnd:"out",toEnd:"out"}),...Y("fast-reversed",Se,5*L,45*L,-(140*O)/(60*L),3,+new Date("2024/04/02"),{color:"#66C0F1",fromEnd:"out",toEnd:"out"})],Pe=l.createContext(void 0),ie=l.createContext({register:()=>{},unregister:()=>{}}),ke=l.createContext(void 0);function Me(e,t,n){let r=e;if(t.some(o=>o.to<r?!0:(r=o.to,!1)))throw new Error("Invalid scale: 'to' must be greater than previous 'to'.");if(t.some(o=>("size"in o?o.size:o.coefficient)<=0))throw new Error("Invalid scale: 'to' must be greater than 'from'.");const a=[];let p=0;r=e;for(let o=0;o<t.length;o++){const d=t[o],T="coefficient"in d?d.coefficient:(d.to-r)/d.size,w="coefficient"in d?(d.to-r)/d.coefficient:d.size;a.push({from:r,to:d.to,pixelFrom:p,pixelTo:p+w,coefficient:T}),p+=w,r=d.to,o&&(a[o].previous=a[o-1],a[o-1].next=a[o])}function b(o){if(o.length===0)throw new Error("Invalid scales: there should be at least one scale.");if(o.length===1)return o[0];{const d=Math.ceil(o.length/2),T=o[d-1].to,w=o[d-1].pixelTo;return{limit:T,pixelLimit:w,from:o[0].from,to:o[o.length-1].to,pixelFrom:o[0].pixelFrom,pixelTo:o[o.length-1].pixelTo,left:b(o.slice(0,d)),right:b(o.slice(d))}}}return b(a)}function fe(e,t){e=R.clamp(e,t.from,t.to);let n=t;for(;"limit"in n;)e<=n.limit?n=n.left:n=n.right;return n}function Ce(e,t){e=R.clamp(e,t.pixelFrom,t.pixelTo);let n=t;for(;"pixelLimit"in n;)e<=n.pixelLimit?n=n.left:n=n.right;return n}function Le(e,t,n){return r=>t+(r-e)/n}function Re(e,t,n){return r=>(r-t)*n+e}function Oe(e,t,n){return r=>{const{from:a,pixelFrom:p,coefficient:b}=fe(r-e,n);return t+p+(r-a)/b}}function Ie(e,t,n){return r=>{const{from:a,pixelFrom:p,coefficient:b}=Ce(r-t,n);return e+a+(r-t-p)*b}}function xe(e,t){return({x:n,y:r})=>({time:e(n),position:t(r)})}function qe(e,t){return({time:n,position:r})=>({x:e(n),y:t(r)})}function pe(e,t,n){if(t<e)return pe(t,e,n).reverse();e=Math.max(e,n.from),t=Math.min(t,n.to);let r=fe(e,n),a=e;const p=[];for(;r.to<t;)r.to!==a&&p.push(r.to),a=r.to,r=r.next;return p}const Ae="#000000",D="#2170B9",De="#EDEDED",X="#B6B2AF",Ne="#797671",_e="#FFFFFFC0",V=10,Fe="IBM Plex Sans",re=1e3,N=60*re,z=60*N,bt=1e3,me=[.2,.4,.8,2.4,12,32,72,1/0],he=[10*re,30*re,1*N,5*N,15*N,30*N,1*z,3*z,6*z,12*z,24*z],se="stop",j=["paths"],J=["graduations","paths","captions","overlay"];function ye(e){const[t,n]=l.useState({width:(e==null?void 0:e.offsetWidth)||1,height:(e==null?void 0:e.offsetHeight)||1});return l.useEffect(()=>{const r=()=>{const a=(e==null?void 0:e.offsetWidth)||1,p=(e==null?void 0:e.offsetHeight)||1;(a!==t.width||p!==t.height)&&n({width:a,height:p})};if(e){const a=new ResizeObserver(r);return a.observe(e),()=>{a.disconnect()}}else{r();return}},[e,t.height,t.width]),t}const ge={},Q={};function He(e){if(Q[e])return Q[e];const t=`#${e.toString(16).padStart(6,"0")}`.toLowerCase();return ge[t]=e,Q[e]=t,t}function ze(e){return ge[e.toLowerCase()]}function ee(e){return e.toString(16).padStart(2,"0").toLowerCase()}function $e(e,t,n){return`#${ee(e)}${ee(t)}${ee(n)}`}function We(e){return we(e).rgba()}const ae="picking",Ze="rendering";function Ye(e,t,n){const r=l.useRef({}),a=l.useRef({}),p=l.useRef(j.reduce((h,y)=>({...h,[y]:new Set}),{})),b=l.useRef(J.reduce((h,y)=>({...h,[y]:new Set}),{})),o=l.useRef(t),d=l.useRef(null),T=ye(e),[w,i]=l.useState(null),m=l.useCallback((h,y)=>{j.forEach(E=>{if(y&&!y.has(E))return;const u=a.current[`${ae}-${E}`],S=p.current[E];if(u){u.clearRect(0,0,u.canvas.width,u.canvas.height);const P=u.getImageData(0,0,u.canvas.width,u.canvas.height);S.forEach(k=>k(P,h)),u.putImageData(P,0,0)}})},[]),g=l.useCallback((h,y)=>{J.forEach(E=>{if(y&&!y.has(E))return;const u=a.current[`${Ze}-${E}`],S=b.current[E];u&&(u.clearRect(0,0,u.canvas.width,u.canvas.height),S.forEach(P=>P(u,h)))})},[]),f=l.useCallback(()=>{g(o.current),m(o.current),d.current&&(window.cancelAnimationFrame(d.current.frameId),d.current=null)},[]),s=l.useCallback(()=>{d.current||(d.current={frameId:window.requestAnimationFrame(f)})},[]),c=l.useCallback(({type:h,layer:y,fn:E})=>{if(h==="picking"){const u=p.current[y];if(u.has(E))throw new Error("This picking function has already been registered.");u.add(E)}else if(h==="rendering"){const u=b.current[y];if(u.has(E))throw new Error("This drawing function has already been registered.");u.add(E)}s()},[]),v=l.useCallback(({type:h,layer:y,fn:E})=>{if(h==="picking"){const u=p.current[y];if(!u.has(E))throw new Error("This picking function has not been registered.");u.delete(E)}else if(h==="rendering"){const u=b.current[y];if(!u.has(E))throw new Error("This drawing function has not been registered.");u.delete(E)}s()},[]);return l.useEffect(()=>{if(!e)return;const h=r.current,y=a.current;[...J.map(u=>({layer:u,type:"rendering"})),...j.map(u=>({layer:u,type:"picking"}))].forEach(({layer:u,type:S})=>{const P=`${S}-${u}`;if(!h[P]){const k=document.createElement("CANVAS"),I=k.getContext("2d");k.style.position="absolute",k.style.inset="0",e.appendChild(k),h[P]=k,y[P]=I,S==="picking"&&(k.style.display="none")}})},[e]),l.useEffect(()=>{o.current=t,f()},[t.fingerprint]),l.useEffect(()=>{for(const h in r.current){const y=r.current[h];y&&(y.style.width=T.width+"px",y.style.height=T.height+"px",y.setAttribute("width",T.width+"px"),y.setAttribute("height",T.height+"px"))}f()},[T]),l.useEffect(()=>{let h=null;j.some(y=>{const E=a.current[`${ae}-${y}`];if(E&&n){const[u,S,P,k]=E.getImageData(n.x,n.y,1,1).data;if(k===255){const I=$e(u,S,P);return h={layer:y,index:ze(I)},!0}}return!1}),R.isEqual(h,w)||i(h)},[n,w]),{canvasContext:l.useMemo(()=>({register:c,unregister:v}),[c,v]),hoveredItem:w}}function je(e,t){const{register:n,unregister:r}=l.useContext(ie);l.useEffect(()=>(n({type:"picking",layer:e,fn:t}),()=>{r({type:"picking",layer:e,fn:t})}),[e,t,n,r])}function G(e,t){const{register:n,unregister:r}=l.useContext(ie);l.useEffect(()=>(n({type:"rendering",layer:e,fn:t}),()=>{r({type:"rendering",layer:e,fn:t})}),[e,t,n,r])}const Be=[[0,0,0,0,0,0,0,4,3,2,1],[0,0,0,0,0,0,4,3,3,2,1],[0,0,0,0,0,6,4,3,3,2,1],[0,0,0,0,6,5,4,3,3,2,1],[0,0,0,6,5,4,3,2,2,2,1],[0,0,6,5,4,4,3,2,2,2,1],[0,6,5,4,4,4,3,2,2,2,1],[6,0,5,4,4,4,3,2,2,2,1]],Ue={1:{width:.5,color:Ae},2:{width:.5,color:D,opacity:.77},3:{width:.5,color:D,opacity:.5},4:{width:.5,color:D,opacity:.5,dashArray:[6,6]},5:{width:.5,color:D,opacity:.5,dashArray:[6,18]},6:{width:1,color:D,opacity:.5,dashArray:[1,12]}},Ge=()=>{const e=l.useCallback((t,{timeScale:n,timeOrigin:r,xOffset:a,yOffset:p,getX:b})=>{const o=t.canvas.width,d=t.canvas.height,T=r-n*a,w=T+n*o,i=1/n*N;let m=[];me.some((f,s)=>i<f?(m=Be[s],!0):!1);const g={};he.map((f,s)=>{const c=m[s];if(!c)return;let v=Math.floor(T/f)*f;for(;v<=w;)g[v]=c,v+=f});for(const f in g){const s=g[f],c=Ue[s];t.strokeStyle=c.color,t.lineWidth=c.width,t.globalAlpha=c.opacity||1,t.setLineDash(c.dashArray||[]),c.dashArray&&(t.lineDashOffset=-p);const v=b(+f);t.beginPath(),t.moveTo(v,0),t.lineTo(v,d),t.stroke()}t.setLineDash([]),t.lineDashOffset=0,t.globalAlpha=1},[]);return G("graduations",e),null},Ke=[[0,0,0,0,0,0,0,0,1,1,1],[0,0,0,0,0,0,0,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,1],[0,0,0,0,0,3,1,1,1,1,1],[0,0,0,3,2,1,1,1,1,1,1],[0,0,0,3,2,1,1,1,1,1,1],[0,0,3,2,1,1,1,1,1,1,1],[0,0,3,2,1,1,1,1,1,1,1]],B=e=>`:${new Date(e).getMinutes().toString().padStart(2,"0")}`,$=(e,t)=>{const n=new Date(e);if(t>1){const r=n.getUTCHours().toString().padStart(2,"0"),a=n.getMinutes().toString().padStart(2,"0");return`${r}:${a}`}else return n.getUTCHours().toString().padStart(2,"0")},U=33,Xe=[()=>"",()=>"",B,B,B,B,$,$,$,$,$],Ve={1:{color:Ne,fontSize:12,topOffset:11},2:{color:X,fontSize:12,topOffset:9},3:{color:X,fontSize:10,topOffset:6},4:{color:X,fontSize:8,topOffset:8}},Je=()=>{const e=l.useCallback((t,{timeScale:n,timeOrigin:r,xOffset:a,getX:p})=>{const b=t.canvas.width,o=t.canvas.height,d=r-n*a,T=d+n*b,w=1/n*N;let i=[];me.some((g,f)=>w<g?(i=Ke[f],!0):!1);const m={};he.map((g,f)=>{const s=i[f];if(!s)return;let c=Math.floor(d/g)*g;for(;c<=T;)s&&(m[c]={level:s,rangeIndex:f}),c+=g}),t.fillStyle="white",t.fillRect(0,o-U,b,o),t.strokeStyle="#979797",t.lineWidth=2,t.beginPath(),t.moveTo(0,o-U),t.lineTo(b,o-U),t.stroke();for(const g in m){const{level:f,rangeIndex:s}=m[g],c=Ve[f],v=Xe[s],M=v(+g,w);t.textAlign="center",t.textBaseline="top",t.fillStyle=c.color,t.font=`${c.fontWeight||"normal"} ${c.fontSize}px ${Fe}`,t.fillText(M,p(+g),o-U+(c.topOffset||0))}},[]);return G("captions",e),null},Qe={1:{width:.5,color:D,opacity:.75},2:{width:.5,color:D,opacity:.25},3:{width:.5,color:De}},et=()=>{const e=l.useCallback((t,{xOffset:n,getY:r,operationalPoints:a})=>{const p=t.canvas.width;a.forEach(b=>{const o=Qe[b.importanceLevel||0];if(!o)return;t.strokeStyle=o.color,t.lineWidth=o.width,t.globalAlpha=o.opacity||1,o.dashArray&&(t.setLineDash(o.dashArray||[]),t.lineDashOffset=-n);const d=r(b.position);typeof d=="number"&&(t.beginPath(),t.moveTo(0,d),t.lineTo(p,d),t.stroke())}),t.setLineDash([]),t.lineDashOffset=0,t.globalAlpha=1},[]);return G("graduations",e),null};function te(e,t){const n=t.getBoundingClientRect();return{x:e.clientX-n.left,y:e.clientY-n.top}}function tt(e){if(typeof e.deltaY<"u")return e.deltaY*-3/360;if(typeof e.detail<"u")return e.detail/-9;throw new Error("Could not extract delta from event.")}function nt(e,t,n){const r=l.useRef(t),[a,p]=l.useState({type:"idle"}),[b,o]=l.useState({isHover:!1,position:{x:NaN,y:NaN}}),{position:d,down:T}=b;l.useEffect(()=>{r.current=t},[t]);const w=l.useCallback(s=>{if(!e)return;const{onClick:c}=r.current;if(c){const v=te(s,e);c({event:s,position:v,data:n(v)})}},[e,n]),i=l.useCallback(s=>{e&&o(c=>({...c,down:{ctrl:s.ctrlKey,shift:s.shiftKey}}))},[e]),m=l.useCallback(()=>{e&&o(s=>({...s,down:void 0}))},[e]),g=l.useCallback(s=>{if(!e)return;const c=te(s,e),{x:v,y:M}=c,h=e.offsetWidth,y=e.offsetHeight,E=v>=0&&v<=h&&M>=0&&M<=y;o(S=>({...S,position:c,isHover:E}));const{onMouseMove:u}=r.current;u&&u({event:s,isHover:E,position:c,data:{position:NaN,time:NaN}})},[e]),f=l.useCallback(s=>{const{onZoom:c}=r.current;c&&e&&c({delta:tt(s),position:te(s,e),event:s})},[e]);return l.useEffect(()=>{if(e)return e.addEventListener("click",w),()=>{e.removeEventListener("click",w)}},[e,w]),l.useEffect(()=>{if(e)return e.addEventListener("mousedown",i),()=>{e.removeEventListener("mousedown",i)}},[e,i]),l.useEffect(()=>(document.addEventListener("mouseup",m),()=>{document.removeEventListener("mouseup",m)}),[m]),l.useEffect(()=>(document.addEventListener("mousemove",g),()=>{document.removeEventListener("mousemove",g)}),[g]),l.useEffect(()=>{if(e)return e.addEventListener("wheel",f),()=>{e.removeEventListener("wheel",f)}},[e,f]),l.useEffect(()=>{const{onPan:s}=r.current;T?p({type:"panning",initialPosition:d,initialData:n(d)}):(a.type==="panning"&&s&&s({isPanning:!1,position:d,initialPosition:a.initialPosition,data:n(d),initialData:a.initialData}),a.type!=="idle"&&p({type:"idle"}))},[T]),l.useEffect(()=>{const{onPan:s}=r.current;a.type==="panning"&&s&&s({isPanning:!0,position:d,initialPosition:a.initialPosition,data:n(d),initialData:a.initialData})},[d]),b}const rt=e=>{const{operationalPoints:t,spaceOrigin:n,spaceScales:r,timeOrigin:a,timeScale:p,xOffset:b=0,yOffset:o=0,onHoveredChildUpdate:d,children:T,onPan:w,onZoom:i,onClick:m,onMouseMove:g,...f}=e,[s,c]=l.useState(null),[v,M]=l.useState(null),{width:h,height:y}=ye(s),E=l.useMemo(()=>JSON.stringify({width:h,height:y,spaceOrigin:n,spaceScales:r,timeOrigin:a,timeScale:p,xOffset:b,yOffset:o}),[h,y,n,r,a,p,b,o]),u=l.useMemo(()=>{const C=Me(n,r),_=Le(a,b,p),Z=Oe(n,o,C),H=qe(_,Z),A=Re(a,b,p),oe=Ie(n,o,C),Ee=xe(A,oe);return{fingerprint:E,width:h,height:y,getX:_,getY:Z,getPoint:H,getTime:A,getSpace:oe,getData:Ee,operationalPoints:t,spaceOrigin:n,spaceScaleTree:C,timeOrigin:a,timeScale:p,xOffset:b,yOffset:o}},[E]),{position:S,down:P,isHover:k}=nt(s,e,u.getData),I=l.useMemo(()=>({position:S,down:P,isHover:k,data:u.getData(S)}),[S,P,k,u]),{canvasContext:F,hoveredItem:q}=Ye(v,u,S);return l.useEffect(()=>{d&&d({item:q})},[q]),x.createElement("div",{...f,ref:c,className:be("relative space-time-chart",f.className)},x.createElement("div",{ref:M,className:"absolute inset-0"}),x.createElement(Pe.Provider,{value:u},x.createElement(ie.Provider,{value:F},x.createElement(ke.Provider,{value:I},x.createElement(et,null),x.createElement(Ge,null),x.createElement(Je,null),T))))};rt.__docgenInfo={description:"",methods:[],displayName:"SpaceTimeChart",props:{children:{required:!1,tsType:{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"},description:""},operationalPoints:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  id: string;
  label: string;
  position: number;
  importanceLevel?: number; // Lower is better. If null, the point won't be displayed.
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"label",value:{name:"string",required:!0}},{key:"position",value:{name:"number",required:!0}},{key:"importanceLevel",value:{name:"number",required:!1}}]}}],raw:"OperationalPoint[]"},description:""},spaceOrigin:{required:!0,tsType:{name:"number"},description:""},spaceScales:{required:!0,tsType:{name:"Array",elements:[{name:"intersection",raw:`{
  // End point (in meters):
  to: number;
} & (
  | {
      // Coefficient (in meters/px):
      coefficient: number;
    }
  | {
      // Size (in px):
      size: number;
    }
)`,elements:[{name:"signature",type:"object",raw:`{
  // End point (in meters):
  to: number;
}`,signature:{properties:[{key:"to",value:{name:"number",required:!0}}]}},{name:"unknown"}]}],raw:"SpaceScale[]"},description:""},timeOrigin:{required:!0,tsType:{name:"number"},description:""},timeScale:{required:!0,tsType:{name:"number"},description:""},xOffset:{required:!1,tsType:{name:"number"},description:""},yOffset:{required:!1,tsType:{name:"number"},description:""},onPan:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: P) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  isPanning: boolean;
  initialPosition: Point;
  position: Point;
  initialData: DataPoint;
  data: DataPoint;
}`,signature:{properties:[{key:"isPanning",value:{name:"boolean",required:!0}},{key:"initialPosition",value:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]},required:!0}},{key:"position",value:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]},required:!0}},{key:"initialData",value:{name:"signature",type:"object",raw:`{
  time: number;
  position: number;
}`,signature:{properties:[{key:"time",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}}]},required:!0}},{key:"data",value:{name:"signature",type:"object",raw:`{
  time: number;
  position: number;
}`,signature:{properties:[{key:"time",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}}]},required:!0}}]}},name:"payload"}],return:{name:"void"}}},description:""},onZoom:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: P) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ delta: number; position: Point; event: WheelEvent }",signature:{properties:[{key:"delta",value:{name:"number",required:!0}},{key:"position",value:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]},required:!0}},{key:"event",value:{name:"WheelEvent",required:!0}}]}},name:"payload"}],return:{name:"void"}}},description:""},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: P) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ position: Point; data: DataPoint; event: MouseEvent }",signature:{properties:[{key:"position",value:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]},required:!0}},{key:"data",value:{name:"signature",type:"object",raw:`{
  time: number;
  position: number;
}`,signature:{properties:[{key:"time",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}}]},required:!0}},{key:"event",value:{name:"MouseEvent",required:!0}}]}},name:"payload"}],return:{name:"void"}}},description:""},onMouseMove:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: P) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ position: Point; data: DataPoint; isHover: boolean; event: MouseEvent }",signature:{properties:[{key:"position",value:{name:"signature",type:"object",raw:`{
  x: number;
  y: number;
}`,signature:{properties:[{key:"x",value:{name:"number",required:!0}},{key:"y",value:{name:"number",required:!0}}]},required:!0}},{key:"data",value:{name:"signature",type:"object",raw:`{
  time: number;
  position: number;
}`,signature:{properties:[{key:"time",value:{name:"number",required:!0}},{key:"position",value:{name:"number",required:!0}}]},required:!0}},{key:"isHover",value:{name:"boolean",required:!0}},{key:"event",value:{name:"MouseEvent",required:!0}}]}},name:"payload"}],return:{name:"void"}}},description:""},onHoveredChildUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"(payload: P) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:"{ item: HoveredItem | null }",signature:{properties:[{key:"item",value:{name:"union",raw:"HoveredItem | null",elements:[{name:"signature",type:"object",raw:"{ layer: PickingLayerType; index: number }",signature:{properties:[{key:"layer",value:{name:"unknown[number]",raw:"(typeof PICKING_LAYERS)[number]",required:!0}},{key:"index",value:{name:"number",required:!0}}]}},{name:"null"}],required:!0}}]}},name:"payload"}],return:{name:"void"}}},description:""}}};function ve(e,t,n,[r,a,p],b,o=Math.ceil(b/2)){if(t.x>n.x)return ve(e,n,t,[r,a,p],b);const d=e.width,T=e.height,w=n.x-t.x,i=n.y-t.y,m=Math.sqrt(w*w+i*i),g=-i/m,f=w/m,s=o,c={x:t.x+(+g-w/m)*s,y:t.y+(+f-i/m)*s},v={x:t.x+(-g-w/m)*s,y:t.y+(-f-i/m)*s},M={x:n.x+(-g+w/m)*s,y:n.y+(-f+i/m)*s},h={x:n.x+(+g+w/m)*s,y:n.y+(+f+i/m)*s},y=t.y<n.y,E=y?h:c,u=y?c:v,S=y?M:h,P=y?v:M,k=R.clamp(Math.floor(u.x),0,d),I=R.clamp(Math.ceil(S.x),0,d),F=R.clamp(Math.floor(P.y),0,T),q=R.clamp(Math.ceil(E.y),0,T);for(let C=F;C<=q;C++){const _=R.clamp(C<u.y?Math.floor(P.x+(C-P.y)*(u.x-P.x)/(u.y-P.y)):Math.floor(u.x+(C-u.y)*(u.x-E.x)/(u.y-E.y)),k,I),Z=R.clamp(C<S.y?Math.ceil(P.x+(C-P.y)*(S.x-P.x)/(S.y-P.y)):Math.ceil(S.x+(C-S.y)*(S.x-E.x)/(S.y-E.y)),k,I);for(let H=_;H<=Z;H++){const A=(C*d+H)*4;e.data[A]=r,e.data[A+1]=a,e.data[A+2]=p,e.data[A+3]=255}}}const ue=6;function it(e,t,n){e.beginPath(),e.moveTo(t,n-ue/2),e.lineTo(t,n+ue/2),e.stroke()}const ne=12;function ot(e,t,n,r,a){const p=r==="from"?1:-1,b=(a==="down"?1:-1)*p,o=t-4*p,d=n+(ne-2)*b;e.beginPath(),e.moveTo(t,n),e.bezierCurveTo(o,d,o,d,t-ne*p,n+ne*b),e.stroke()}function ce(e,t,n,r,a,p){p==="out"?ot(e,t,n,r,a):it(e,t,n)}function st({points:e},t){if(e.length<2)return"down";for(let n=1,r=Math.min(3,e.length);n<r;n++){const a=e[n].position-e[n-1].position;if(a>0)return"up";if(a<0)return"down"}return"down"}const at=5,ut=7,ct=.2,le={1:{width:1.5,endWidth:1.5},2:{width:1,endWidth:1},3:{width:1,endWidth:1,dashArray:[5,5],lineCap:"square"},4:{width:1.5,endWidth:1,dashArray:[0,4],lineCap:"round"}},lt=2,wt=({index:e,path:t,color:n,level:r=lt,pickingTolerance:a=at})=>{const p=l.useCallback(({getX:i,getY:m,spaceScaleTree:g})=>{const f=[];return t.points.forEach(({position:s,time:c},v,M)=>{if(!v)f.push({x:i(c),y:m(s)});else{const{position:h,time:y}=M[v-1];pe(h,s,g).forEach(u=>{const S=y+(u-h)/(s-h)*(c-y);f.push({x:i(S),y:m(u)})}),f.push({x:i(c),y:m(s)})}}),f},[t]),b=l.useCallback((i,{getX:m,getY:g,operationalPoints:f})=>{const s=new Set(f.map(c=>c.position));t.points.forEach(({position:c,time:v},M,h)=>{if(M){const{position:y,time:E}=h[M-1];if(y===c&&s.has(c)){const u=g(c);i.beginPath(),i.moveTo(m(E),u),i.lineTo(m(v),u),i.stroke()}}})},[t]),o=l.useCallback((i,m,g,f)=>{if(!m)return;const s=i.canvas.width,c=i.canvas.height,v=f.findIndex(({x:C,y:_})=>R.inRange(C,0,s)&&R.inRange(_,0,c));if(v<0)return;const M=f[v-1],h=f[v],y=f[v+1];let E=h,u=0;v===0?y&&(u=Math.atan2(y.y-h.y,y.x-h.x)):(E={x:0,y:h.y-h.x*(h.y-M.y)/(h.x-M.x)},u=Math.atan2(h.y-E.y,h.x-E.x)),i.save(),i.translate(E.x,E.y),i.rotate(u),i.font=`${V}px IBM Plex Mono`,i.textAlign="start";const S=5,P=u>=0?-5:15,k=2,F=i.measureText(m).width+2*k,q=V+2*k;i.fillStyle=_e,i.fillRect(S-k,P-q+k,F,q),i.fillStyle=g,i.fillText(m,S,P-V/4),i.restore()},[]),d=l.useCallback((i,{getX:m,getY:g})=>{const f=st(t),s=t.points[0],c=t.fromEnd||se,v=R.last(t.points),M=t.toEnd||se;ce(i,m(s.time),g(s.position),"from",f,c),ce(i,m(v.time),g(v.position),"to",f,M)},[t]),T=l.useCallback((i,m)=>{i.strokeStyle=n,i.lineWidth=ut,i.globalAlpha=ct,i.lineCap="round",b(i,m);const g=le[r];i.strokeStyle=n,i.lineWidth=g.width,i.setLineDash(g.dashArray||[]),i.globalAlpha=g.opacity||1,i.lineCap=g.lineCap||"square",i.beginPath();const f=p(m);f.forEach(({x:s,y:c},v)=>{v?i.lineTo(s,c):i.moveTo(s,c)}),i.stroke(),i.setLineDash([]),i.lineWidth=g.endWidth,d(i,m),o(i,t.label,n,f)},[n,b,r,p,d,o,t.label]);G("paths",T);const w=l.useCallback((i,m)=>{const g=We(He(e));p(m).forEach((f,s,c)=>{if(s){const v=c[s-1];ve(i,v,f,g,le[r].width+a)}})},[e,p,r,a]);return je("paths",w),null},K=200,dt=1/K,ft=K,pt=1/K,mt=K,Tt=6,St=3;function Pt(e,{delta:t,position:{x:n,y:r}}){const a=Math.min(Math.max(e.xZoomLevel*(1+t/10),dt),ft),p=Math.min(Math.max(e.yZoomLevel*(1+t/10),pt),mt);return{xZoomLevel:a,yZoomLevel:p,xOffset:n-(n-e.xOffset)/e.xZoomLevel*a,yOffset:r-(r-e.yOffset)/e.yZoomLevel*p}}export{bt as K,ke as M,W as O,Et as P,rt as S,_e as W,Tt as X,St as Y,wt as a,Pe as b,N as c,dt as d,ft as e,pt as f,Y as g,mt as h,Pt as z};
